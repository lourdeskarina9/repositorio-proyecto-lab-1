#include <Wire.h>               
#include <virtuabotixRTC.h>

virtuabotixRTC myRTC(5, 4, 3);         //CLK=5, DAT=4, RST=3

void setup() {
//Esto se pone en el SETUP, por el monitor serial va a pedir que se ingrese manualmente la fecha y hora. 
//Solo es necesario hacer esto UNA sola vez.
//Cuando ya esté configurado el clock, se puede borrar este código, no va a pasar nada.
Serial.begin(9600);

while (!Serial); // Espera a que el monitor serial esté listo
  Serial.println("Esperando hora desde PC (formato: YYYY-MM-DD HH:MM:SS)");

  while (Serial.available() == 0); // Espera entrada
  String fechaHora = Serial.readStringUntil('\n');

  //Parseo de fecha y hora
  int year = fechaHora.substring(0, 4).toInt();
  int month = fechaHora.substring(5, 7).toInt();
  int day = fechaHora.substring(8, 10).toInt();
  int hour = fechaHora.substring(11, 13).toInt();
  int minute = fechaHora.substring(14, 16).toInt();
  int second = fechaHora.substring(17, 19).toInt();

  //Para poner el número del día de la semana
  //1 - Lunes
  //2 - Martes
  //3 - Miércoles
  //4 - Jueves
  //5 - Viernes
  //6 - Sábado
  //7 - Domingo
  int dayOfWeek = 1;

  myRTC.setDS1302Time(second, minute, hour, dayOfWeek, day, month, year);

  Serial.println("Clock set");

}

void loop() {
  // put your main code here, to run repeatedly:
}

